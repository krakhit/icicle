"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[4927],{5680:(e,i,n)=>{n.d(i,{xA:()=>u,yg:()=>m});var t=n(6540);function a(e,i,n){return i in e?Object.defineProperty(e,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[i]=n,e}function r(e,i){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);i&&(t=t.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),n.push.apply(n,t)}return n}function l(e){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{};i%2?r(Object(n),!0).forEach((function(i){a(e,i,n[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))}))}return e}function o(e,i){if(null==e)return{};var n,t,a=function(e,i){if(null==e)return{};var n,t,a={},r=Object.keys(e);for(t=0;t<r.length;t++)n=r[t],i.indexOf(n)>=0||(a[n]=e[n]);return a}(e,i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)n=r[t],i.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=t.createContext({}),s=function(e){var i=t.useContext(c),n=i;return e&&(n="function"==typeof e?e(i):l(l({},i),e)),n},u=function(e){var i=s(e.components);return t.createElement(c.Provider,{value:i},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var i=e.children;return t.createElement(t.Fragment,{},i)}},g=t.forwardRef((function(e,i){var n=e.components,a=e.mdxType,r=e.originalType,c=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=s(n),g=a,m=d["".concat(c,".").concat(g)]||d[g]||p[g]||r;return n?t.createElement(m,l(l({ref:i},u),{},{components:n})):t.createElement(m,l({ref:i},u))}));function m(e,i){var n=arguments,a=i&&i.mdxType;if("string"==typeof e||a){var r=n.length,l=new Array(r);l[0]=g;var o={};for(var c in i)hasOwnProperty.call(i,c)&&(o[c]=i[c]);o.originalType=e,o[d]="string"==typeof e?e:a,l[1]=o;for(var s=2;s<r;s++)l[s]=n[s];return t.createElement.apply(null,l)}return t.createElement.apply(null,n)}g.displayName="MDXCreateElement"},491:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>o,toc:()=>s});var t=n(8168),a=(n(6540),n(5680));n(1873);const r={},l="Icicle Release README",o={unversionedId:"icicle/primitives/Icicle_Release_README",id:"icicle/primitives/Icicle_Release_README",title:"Icicle Release README",description:"Overview",source:"@site/docs/icicle/primitives/Icicle_Release_README.md",sourceDirName:"icicle/primitives",slug:"/icicle/primitives/Icicle_Release_README",permalink:"/icicle/primitives/Icicle_Release_README",editUrl:"https://github.com/ingonyama-zk/icicle/tree/main/docs/icicle/primitives/Icicle_Release_README.md",tags:[],version:"current",lastUpdatedBy:"Otsar",lastUpdatedAt:1725444871,formattedLastUpdatedAt:"9/4/2024",frontMatter:{}},c={},s=[{value:"Overview",id:"overview",level:2},{value:"Content of a Release",id:"content-of-a-release",level:2},{value:"Considerations",id:"considerations",level:3},{value:"Build Docker Image",id:"build-docker-image",level:2},{value:"Docker Environment Explanation",id:"docker-environment-explanation",level:3},{value:"Build Libraries Inside the Docker",id:"build-libraries-inside-the-docker",level:2},{value:"Installing and Using the Release",id:"installing-and-using-the-release",level:2},{value:"Backend Loading",id:"backend-loading",level:2},{value:"Custom Backend Loading",id:"custom-backend-loading",level:3}],u={toc:s},d="wrapper";function p(e){let{components:i,...n}=e;return(0,a.yg)(d,(0,t.A)({},u,n,{components:i,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"icicle-release-readme"},"Icicle Release README"),(0,a.yg)("h2",{id:"overview"},"Overview"),(0,a.yg)("p",null,"Icicle is a powerful C++ library designed to provide flexible and efficient computation through its modular backend architecture. This README explains how to build and release Icicle for multiple Linux distributions, including Ubuntu 20.04, Ubuntu 22.04, and CentOS 7. It also describes the content of a release and how to use the generated tar files."),(0,a.yg)("h2",{id:"content-of-a-release"},"Content of a Release"),(0,a.yg)("p",null,"Each Icicle release includes a tar file containing the build artifacts for a specific distribution. The tar file includes the following structure:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},(0,a.yg)("inlineCode",{parentName:"strong"},"./icicle/include/")),": This directory contains all the necessary header files for using the Icicle library from C++."),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},(0,a.yg)("inlineCode",{parentName:"strong"},"./icicle/lib/")),": ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Icicle Libraries"),": All the core Icicle libraries are located in this directory. Applications linking to Icicle will use these libraries."),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Backends"),": The ",(0,a.yg)("inlineCode",{parentName:"li"},"./icicle/lib/backend/")," directory houses backend libraries, including the CUDA backend. While the CUDA backend is included, it will only be used on machines with a GPU. On machines without a GPU, the CUDA backend is not utilized.")))),(0,a.yg)("h3",{id:"considerations"},"Considerations"),(0,a.yg)("p",null,"Currently, the CUDA backend is included in every installation tar file, even on machines without a GPU. This ensures consistency across installations but results in additional files being installed that may not be used. "),(0,a.yg)("h2",{id:"build-docker-image"},"Build Docker Image"),(0,a.yg)("p",null,"To build the Docker images for each distribution and CUDA version, use the following commands:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"# Ubuntu 22.04, CUDA 12.2\ndocker build -t icicle-release-ubuntu22-cuda122 -f Dockerfile.ubuntu22 .\n\n# Ubuntu 20.04, CUDA 12.2\ndocker build -t icicle-release-ubuntu20-cuda122 -f Dockerfile.ubuntu20 .\n\n# CentOS 7, CUDA 12.2\ndocker build -t icicle-release-centos7-cuda122 -f Dockerfile.centos7 .\n")),(0,a.yg)("h3",{id:"docker-environment-explanation"},"Docker Environment Explanation"),(0,a.yg)("p",null,"The Docker images you build represent the target environment for the release. Each Docker image is tailored to a specific distribution and CUDA version. You first build the Docker image, which sets up the environment, and then use this Docker image to build the release tar file. This ensures that the build process is consistent and reproducible across different environments."),(0,a.yg)("h2",{id:"build-libraries-inside-the-docker"},"Build Libraries Inside the Docker"),(0,a.yg)("p",null,"To build the Icicle libraries inside a Docker container and output the tar file to the ",(0,a.yg)("inlineCode",{parentName:"p"},"release_output")," directory:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"mkdir -p release_output\ndocker run --rm --gpus all              -v ./icicle:/icicle                 -v ./release_output:/output         -v ./scripts:/scripts               icicle-release-ubuntu22-cuda122 bash /scripts/release/build_release_and_tar.sh\n")),(0,a.yg)("p",null,"This command executes the ",(0,a.yg)("inlineCode",{parentName:"p"},"build_release_and_tar.sh")," script inside the Docker container, which provides the build environment. It maps the source code and output directory to the container, ensuring the generated tar file is available on the host system."),(0,a.yg)("p",null,"You can replace ",(0,a.yg)("inlineCode",{parentName:"p"},"icicle-release-ubuntu22-cuda122")," with another Docker image tag to build in the corresponding environment (e.g., Ubuntu 20.04 or CentOS 7)."),(0,a.yg)("h2",{id:"installing-and-using-the-release"},"Installing and Using the Release"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Extract the Tar File"),":"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Download the appropriate tar file for your distribution (Ubuntu 20.04, Ubuntu 22.04, or CentOS 7)."),(0,a.yg)("li",{parentName:"ul"},"Extract it to your desired location:",(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"tar -xzvf icicle-<distribution>-cuda122.tar.gz -C /path/to/install/location\n"))))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Linking Your Application"),":"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"When compiling your C++ application, link against the Icicle libraries found in ",(0,a.yg)("inlineCode",{parentName:"li"},"./icicle/lib/"),":",(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"g++ -o myapp myapp.cpp -L/path/to/icicle/lib -licicle_device -licicle_field_or_curve\n"))),(0,a.yg)("li",{parentName:"ul"},"Note: You only need to link to the Icicle device and field or curve libraries. The backend libraries are dynamically loaded at runtime.")))),(0,a.yg)("h2",{id:"backend-loading"},"Backend Loading"),(0,a.yg)("p",null,"The Icicle library dynamically loads backend libraries at runtime. By default, it searches for backends in the following order:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Environment Variable"),": If the ",(0,a.yg)("inlineCode",{parentName:"li"},"ICICLE_BACKEND_INSTALL_DIR")," environment variable is defined, Icicle will prioritize this location."),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Default Directory"),": If the environment variable is not set, Icicle will search in the default directory ",(0,a.yg)("inlineCode",{parentName:"li"},"/opt/icicle/lib/backend"),".")),(0,a.yg)("h3",{id:"custom-backend-loading"},"Custom Backend Loading"),(0,a.yg)("p",null,"If you need to load a backend from a custom location at any point during runtime, you can call the following function:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-cpp"},'extern "C" eIcicleError icicle_load_backend(const char* path, bool is_recursive);\n')),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},(0,a.yg)("inlineCode",{parentName:"strong"},"path")),": The directory where the backend libraries are located."),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},(0,a.yg)("inlineCode",{parentName:"strong"},"is_recursive")),": If ",(0,a.yg)("inlineCode",{parentName:"li"},"true"),", the function will search for backend libraries recursively within the specified path.")),(0,a.yg)("hr",null))}p.isMDXComponent=!0},1873:(e,i,n)=>{n(6540)}}]);